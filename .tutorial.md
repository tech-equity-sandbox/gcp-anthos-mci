## Getting started

Depending on the platform setup, the asset may initialize automatically or may need to be manually executed. To manually execute the asset, run the command `./gcp-anthos-mci.sh` on the terminal.

When you run the script, it sets up the pre-requisite automation tools behind the scenes. 

Please be patient, and allow a few seconds for the lab to initialize. 

You will be prompted to enter any key to continue once the initialization process is complete.

If the tutorial is not displayed automatically, enter `0` below the `What additional steps do you want to perform...` prompt.

There are 3 modes of operation. 

Change the mode by selecting step `m`, and enter your preference by selecting an option from the list below:

- `y` to preview configuration or commands.
- `n` to execute commands in the create mode.
- `d` to delete resources in the delete mode.

Click the **START** button below to continue to the next page.

## Selecting a project

You need to select a project for this lab.

*Hint: You should be the Owner or Editor of this project. We recommend deleting the project at the end of the lab or using the `d` option to delete provisioned resources and avoid incurring additional costs.*

Change the mode by selecting step `m`, and select the create mode by entering `n` at the prompt.

If prompted for a code, enter a valid code. For help, contact `support@techequity.cloud`.

Click the **NEXT** button to continue.

## Sign in

You need to authenticate to `gcloud` to complete the lab.

When prompted to authenticate, enter `y`, click the link displayed, sign-in using your Google Cloud account, and click the `Allow` button to grant permissions to Google Cloud SDK. 

Click the `Copy` button to copy the authorization code. 

Return to the cloud shell terminal and paste the authorization code into the prompt to authenticate to cloud shell.

When prompted to change the project from `NOT_SET`, enter `y` and enter your project ID. 

Enter any key at the `$` prompt to return to the menu, and click the **NEXT** button to continue.

## Explore Traffic Management, Resiliency and Telemetry Features using ASM

This asset enables you to explore traffic management, resiliency and telemetry features using Anthos Service Mesh on the Google Cloud. 

**Time to complete**: About 45 minutes

**Prerequisites**: You need Project Owner or Editor Role.

### Outline

This asset enables you to perform the following activities:

 - Install tools
 - Enable APIs
 - Create Kubernetes cluster
 - Install ASM components in Kubernetes clusters
 - Deploy microservices into clusters
 - Configure multicluster ingress 

Click the **NEXT** button to continue.

## Step 0: Launch step by step guide

Use this option to launch an interactive step by step guide. 

If new to this experience, follow the guide carefully. 

As your experience grows, the need to refer to this guide will diminish, as the lab experience is intuitive.

Enter any key at the `$` prompt in the cloud shell terminal.

## Step 1: Install tools

Enter `1` at the `additional steps to perform` prompt to download and extract Anthos Service Mesh. 

Note the Anthos Service Mesh version.

Explore the downloaded and extracted files on the local file system.

To enable APIs, click the **NEXT** button.

Enter any key at the `$` prompt in the cloud shell terminal.

## Step 2: Enable APIs

You need to enable the APIs in the project to perform the required tasks. 

You only need to do this once for your project. 

Enter `2` at the `additional steps to perform` prompt to enable the API.  

Note the list of APIs enabled.

To create Kubernetes cluster, click the **NEXT** button.

Enter any key at the `$` prompt in the cloud shell terminal.

## Step 3 Create Kubernetes clusters

Enter `3` at the `additional steps to perform` prompt to create a Kubernetes cluster. 

Note the comments describing each command, and the cluster creation parameters.

The command has been simplified and includes only non-default values.

Navigate to `https://console.cloud.google.com/kubernetes/list/overview?project={{project-id}}` to explore the Kubernetes cluster on the console.

To install Anthos Service Mesh, click the **NEXT** button.

Enter any key at the `$` prompt in the cloud shell terminal.

## Step 4: Install Anthos Service Mesh

Enter `4` at the `additional steps to perform` prompt to install Anthos Service Mesh.

Note the comments associated with each command.

Navigate to `https://console.cloud.google.com/kubernetes/workload/overview?project={{project-id}}` to explore Anthos Service Mesh and addon workloads in the console.

To deploy microservices into clusters, click the **NEXT** button.

Enter any key at the `$` prompt in the cloud shell terminal.

## Step 5: Deploy microservices into clusters

Enter `5` at the `additional steps to perform` prompt to deploy microservices into clusters.

Note the commands and associated comments.

Navigate to `https://console.cloud.google.com/kubernetes/workload/overview?cloudshell=false&project={{project-id}}` to explore workloads in the console.

Navigate to `https://console.cloud.google.com/kubernetes/discovery?cloudshell=false&project={{project-id}}` to explore services in the console.

To configure multicluster ingress, click the **NEXT** button.

Enter any key at the `$` prompt in the cloud shell terminal.

## Step 6: Configure multicluster ingress 

Enter `6` at the `additional steps to perform` prompt to configure multicluster ingress.

Note the commands and associated comments.

Navigate to `https://console.cloud.google.com/kubernetes/objectKind/networking.gke.io/multiclusteringresses?apiVersion=v1&kind=MULTI_CLUSTER_INGRESS&project={{project-id}}` to explore the multi-cluster ingress configuration in the console.

Navigate to `https://console.cloud.google.com/kubernetes/objectKind/networking.gke.io/multiclusterservices?apiVersion=v1&kind=MULTI_CLUSTER_SERVICE&project={{project-id}}` to explore the multi-cluster service configuration in the console.

Navigate to `https://console.cloud.google.com/kubernetes/objectKind/networking.gke.io/servicenetworkendpointgroups?apiVersion=v1beta1&project={{project-id}}` to explore the service network endpoint groups in the console.

Navigate to `https://console.cloud.google.com/kubernetes/ingresses?cloudshell=false&project={{project-id}}` to explore ingress in the console.

Navigate to `https://console.cloud.google.com/net-services/loadbalancing/list/loadBalancers?cloudshell=false&project={{project-id}}` to explore load balancer in the console.

Congratulations! You have completed the setup.

Enter any key at the `$` prompt in the cloud shell terminal.
